<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Julia Layne" />


<title>Job Attrition and Retention</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Scientist Profile</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Info</a>
</li>
<li>
  <a href="AmericanBreweryStudy.html">Breweries Study</a>
</li>
<li>
  <a href="DDSAnalyticsEDA.html">Attrition Case Study</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Job Attrition and Retention</h1>
<h4 class="author">Julia Layne</h4>
<h4 class="date">4/10/2020</h4>

</div>


<div id="intro" class="section level2">
<h2>Intro</h2>
</div>
<div id="executive-summary" class="section level2">
<h2>Executive summary</h2>
<p>Hiring and training employees only to see them walk out the door is expensive. DDSAnalytics would like to give companies the foresight in predicting employee attrition. In this analysis we will identify potential characteristics of attrition and estimate the salary of employees. We found that Overtime was disproportionate in employees that left the company. Lower Job Levels and Job Satifaction also contritbute to Attrition. Ensuring employees have a way to go up in level could be one way to mitigate Attrition. Considering the disproportionate amount of Overtime in those who chose to leave, it is important to pay attention to the job satisfaction of lower level employees who may be new to a position.</p>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This analysis will begin with a review of the data from 870 employees used to predict the outcomes for the provided competition set. First we will look at the top three fields in each prediction section: Attrition and Salary (MonthlyRate). We scaled numeric values for comparison. K-Nearest neighbors is used for the Attrition Model looking at: Overtime, Job Satisfaction, and Job Level. For the Salary, we estimated this using Linear Regression looking at: Age, Job Satisfaction, and Job Level.</p>
</div>
<div id="links-to-supporting-material" class="section level2">
<h2>Links to supporting material</h2>
<div id="presentation" class="section level3">
<h3>Presentation</h3>
<p><a href="https://youtu.be/jEbQSMZb7KY">Presentation Available</a></p>
</div>
</div>
<div id="initial-data" class="section level2">
<h2>Initial Data</h2>
<p>Reading in the data for training</p>
<pre class="r"><code>jobs = read.csv(&quot;CaseStudy2-data.csv&quot;,header = TRUE)</code></pre>
<div id="a-summary-of-the-data" class="section level3">
<h3>A Summary of the Data</h3>
<p>We found no missing values in the dataset. This allows us to use every row in considering which fields to consider in our analysis.</p>
<pre class="r"><code>#Find out which columns have missing values
missing &lt;- colSums(is.na(jobs))&gt;0
missing</code></pre>
<pre><code>##                       ID                      Age                Attrition 
##                    FALSE                    FALSE                    FALSE 
##           BusinessTravel                DailyRate               Department 
##                    FALSE                    FALSE                    FALSE 
##         DistanceFromHome                Education           EducationField 
##                    FALSE                    FALSE                    FALSE 
##            EmployeeCount           EmployeeNumber  EnvironmentSatisfaction 
##                    FALSE                    FALSE                    FALSE 
##                   Gender               HourlyRate           JobInvolvement 
##                    FALSE                    FALSE                    FALSE 
##                 JobLevel                  JobRole          JobSatisfaction 
##                    FALSE                    FALSE                    FALSE 
##            MaritalStatus            MonthlyIncome              MonthlyRate 
##                    FALSE                    FALSE                    FALSE 
##       NumCompaniesWorked                   Over18                 OverTime 
##                    FALSE                    FALSE                    FALSE 
##        PercentSalaryHike        PerformanceRating RelationshipSatisfaction 
##                    FALSE                    FALSE                    FALSE 
##            StandardHours         StockOptionLevel        TotalWorkingYears 
##                    FALSE                    FALSE                    FALSE 
##    TrainingTimesLastYear          WorkLifeBalance           YearsAtCompany 
##                    FALSE                    FALSE                    FALSE 
##       YearsInCurrentRole  YearsSinceLastPromotion     YearsWithCurrManager 
##                    FALSE                    FALSE                    FALSE</code></pre>
<p>An overview of the range of values in fields.</p>
<pre class="r"><code>summary(jobs) </code></pre>
<pre><code>##        ID             Age        Attrition           BusinessTravel
##  Min.   :  1.0   Min.   :18.00   No :730   Non-Travel       : 94   
##  1st Qu.:218.2   1st Qu.:30.00   Yes:140   Travel_Frequently:158   
##  Median :435.5   Median :35.00             Travel_Rarely    :618   
##  Mean   :435.5   Mean   :36.83                                     
##  3rd Qu.:652.8   3rd Qu.:43.00                                     
##  Max.   :870.0   Max.   :60.00                                     
##                                                                    
##    DailyRate                       Department  DistanceFromHome   Education    
##  Min.   : 103.0   Human Resources       : 35   Min.   : 1.000   Min.   :1.000  
##  1st Qu.: 472.5   Research &amp; Development:562   1st Qu.: 2.000   1st Qu.:2.000  
##  Median : 817.5   Sales                 :273   Median : 7.000   Median :3.000  
##  Mean   : 815.2                                Mean   : 9.339   Mean   :2.901  
##  3rd Qu.:1165.8                                3rd Qu.:14.000   3rd Qu.:4.000  
##  Max.   :1499.0                                Max.   :29.000   Max.   :5.000  
##                                                                                
##           EducationField EmployeeCount EmployeeNumber   EnvironmentSatisfaction
##  Human Resources : 15    Min.   :1     Min.   :   1.0   Min.   :1.000          
##  Life Sciences   :358    1st Qu.:1     1st Qu.: 477.2   1st Qu.:2.000          
##  Marketing       :100    Median :1     Median :1039.0   Median :3.000          
##  Medical         :270    Mean   :1     Mean   :1029.8   Mean   :2.701          
##  Other           : 52    3rd Qu.:1     3rd Qu.:1561.5   3rd Qu.:4.000          
##  Technical Degree: 75    Max.   :1     Max.   :2064.0   Max.   :4.000          
##                                                                                
##     Gender      HourlyRate     JobInvolvement     JobLevel    
##  Female:354   Min.   : 30.00   Min.   :1.000   Min.   :1.000  
##  Male  :516   1st Qu.: 48.00   1st Qu.:2.000   1st Qu.:1.000  
##               Median : 66.00   Median :3.000   Median :2.000  
##               Mean   : 65.61   Mean   :2.723   Mean   :2.039  
##               3rd Qu.: 83.00   3rd Qu.:3.000   3rd Qu.:3.000  
##               Max.   :100.00   Max.   :4.000   Max.   :5.000  
##                                                               
##                       JobRole    JobSatisfaction  MaritalStatus MonthlyIncome  
##  Sales Executive          :200   Min.   :1.000   Divorced:191   Min.   : 1081  
##  Research Scientist       :172   1st Qu.:2.000   Married :410   1st Qu.: 2840  
##  Laboratory Technician    :153   Median :3.000   Single  :269   Median : 4946  
##  Manufacturing Director   : 87   Mean   :2.709                  Mean   : 6390  
##  Healthcare Representative: 76   3rd Qu.:4.000                  3rd Qu.: 8182  
##  Sales Representative     : 53   Max.   :4.000                  Max.   :19999  
##  (Other)                  :129                                                 
##   MonthlyRate    NumCompaniesWorked Over18  OverTime  PercentSalaryHike
##  Min.   : 2094   Min.   :0.000      Y:870   No :618   Min.   :11.0     
##  1st Qu.: 8092   1st Qu.:1.000              Yes:252   1st Qu.:12.0     
##  Median :14074   Median :2.000                        Median :14.0     
##  Mean   :14326   Mean   :2.728                        Mean   :15.2     
##  3rd Qu.:20456   3rd Qu.:4.000                        3rd Qu.:18.0     
##  Max.   :26997   Max.   :9.000                        Max.   :25.0     
##                                                                        
##  PerformanceRating RelationshipSatisfaction StandardHours StockOptionLevel
##  Min.   :3.000     Min.   :1.000            Min.   :80    Min.   :0.0000  
##  1st Qu.:3.000     1st Qu.:2.000            1st Qu.:80    1st Qu.:0.0000  
##  Median :3.000     Median :3.000            Median :80    Median :1.0000  
##  Mean   :3.152     Mean   :2.707            Mean   :80    Mean   :0.7839  
##  3rd Qu.:3.000     3rd Qu.:4.000            3rd Qu.:80    3rd Qu.:1.0000  
##  Max.   :4.000     Max.   :4.000            Max.   :80    Max.   :3.0000  
##                                                                           
##  TotalWorkingYears TrainingTimesLastYear WorkLifeBalance YearsAtCompany  
##  Min.   : 0.00     Min.   :0.000         Min.   :1.000   Min.   : 0.000  
##  1st Qu.: 6.00     1st Qu.:2.000         1st Qu.:2.000   1st Qu.: 3.000  
##  Median :10.00     Median :3.000         Median :3.000   Median : 5.000  
##  Mean   :11.05     Mean   :2.832         Mean   :2.782   Mean   : 6.962  
##  3rd Qu.:15.00     3rd Qu.:3.000         3rd Qu.:3.000   3rd Qu.:10.000  
##  Max.   :40.00     Max.   :6.000         Max.   :4.000   Max.   :40.000  
##                                                                          
##  YearsInCurrentRole YearsSinceLastPromotion YearsWithCurrManager
##  Min.   : 0.000     Min.   : 0.000          Min.   : 0.00       
##  1st Qu.: 2.000     1st Qu.: 0.000          1st Qu.: 2.00       
##  Median : 3.000     Median : 1.000          Median : 3.00       
##  Mean   : 4.205     Mean   : 2.169          Mean   : 4.14       
##  3rd Qu.: 7.000     3rd Qu.: 3.000          3rd Qu.: 7.00       
##  Max.   :18.000     Max.   :15.000          Max.   :17.00       
## </code></pre>
<pre class="r"><code>originalJobs &lt;- jobs</code></pre>
</div>
<div id="import-libraries" class="section level3">
<h3>Import Libraries</h3>
<p>R Libraries we will use for our analysis</p>
<pre><code>## 
## Attaching package: &#39;reshape2&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     smiths</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<pre><code>## 
## Attaching package: &#39;GGally&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     nasa</code></pre>
</div>
<div id="the-best-predictors-found-for-both-models" class="section level3">
<h3>The Best Predictors found for both Models</h3>
<p>For Attrition this was Overtime, Job Satisfaction, and Job Level For Salary, we switched Overtime for Age.</p>
<pre><code>## 
 plot: [1,1] [==&gt;-----------------------------------------------]  6% est: 0s 
 plot: [1,2] [=====&gt;--------------------------------------------] 12% est: 1s 
 plot: [1,3] [========&gt;-----------------------------------------] 19% est: 2s 
 plot: [1,4] [===========&gt;--------------------------------------] 25% est: 2s 
 plot: [2,1] [===============&gt;----------------------------------] 31% est: 2s 
 plot: [2,2] [==================&gt;-------------------------------] 38% est: 2s 
 plot: [2,3] [=====================&gt;----------------------------] 44% est: 2s 
 plot: [2,4] [========================&gt;-------------------------] 50% est: 1s 
 plot: [3,1] [===========================&gt;----------------------] 56% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [3,2] [==============================&gt;-------------------] 62% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [3,3] [=================================&gt;----------------] 69% est: 1s 
 plot: [3,4] [=====================================&gt;------------] 75% est: 1s 
 plot: [4,1] [========================================&gt;---------] 81% est: 0s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,2] [===========================================&gt;------] 88% est: 0s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,3] [==============================================&gt;---] 94% est: 0s 
 plot: [4,4] [==================================================]100% est: 0s 
                                                                              </code></pre>
<p><img src="DDSAnalyticsEDA_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre><code>## plot: [1,1] [==&gt;-----------------------------------------------] 6% est: 0s
## plot: [1,2] [=====&gt;--------------------------------------------] 12% est: 0s
## plot: [1,3] [========&gt;-----------------------------------------] 19% est: 0s
## plot: [1,4] [===========&gt;--------------------------------------] 25% est: 0s
## plot: [2,1] [===============&gt;----------------------------------] 31% est: 0s
## plot: [2,2] [==================&gt;-------------------------------] 38% est: 0s
## plot: [2,3] [=====================&gt;----------------------------] 44% est: 0s
## plot: [2,4] [========================&gt;-------------------------] 50% est: 0s
## plot: [3,1] [===========================&gt;----------------------] 56% est: 0s
## plot: [3,2] [==============================&gt;-------------------] 62% est: 0s
## plot: [3,3] [=================================&gt;----------------] 69% est: 0s
## plot: [3,4] [=====================================&gt;------------] 75% est: 0s
## plot: [4,1] [========================================&gt;---------] 81% est: 0s
## plot: [4,2] [===========================================&gt;------] 88% est: 0s
## plot: [4,3] [==============================================&gt;---] 94% est: 0s
## plot: [4,4] [==================================================]100% est: 0s</code></pre>
<p><img src="DDSAnalyticsEDA_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
</div>
</div>
<div id="over-time-contributing-to-attrition" class="section level2">
<h2>Over Time Contributing to Attrition</h2>
<p>There was a disproportionate amount of overtime in the group of employees that had left. Despite being less than half the number that didn’t leave(“No”), the group that left were nearly split in half between overtime and Not</p>
<pre class="r"><code>summary(jobs$OverTime)</code></pre>
<pre><code>##  No Yes 
## 618 252</code></pre>
<pre class="r"><code>jobs %&gt;% ggplot(aes(x=OverTime)) + geom_histogram(stat=&quot;count&quot;,mapping = aes(color=Attrition, fill=Attrition)) + ggtitle(&quot;Attrition vs Over Time&quot;)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="DDSAnalyticsEDA_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>jobs %&gt;% ggplot(aes(x=JobSatisfaction)) + geom_histogram(stat=&quot;count&quot;,mapping = aes(color=Attrition, fill=Attrition)) + ggtitle(&quot;Attrition vs Job Satisfaction&quot;)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="DDSAnalyticsEDA_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="data-transformations" class="section level2">
<h2>Data Transformations</h2>
<p>Scaling the numeric variables allows us to compare each row to the variation in the overall dataset. We did this by subtracting the mean of that field, then dividing by the standard deviation.</p>
<pre class="r"><code>jobs&lt;-originalJobs
dummyBoolean &lt;- function(boolean) { 
bool &lt;- 0
if(grepl(&#39;Yes&#39;, boolean,ignore.case = TRUE))
{bool &lt;-1} 
bool
}
transformFields &lt;- function(dataset){
  dummied_overTime &lt;- dataset %&gt;% mutate(OverTimeDummy =sapply(OverTime, dummyBoolean,simplify = TRUE))
  scaledYear &lt;- dummied_overTime %&gt;% mutate(scaledYears = (YearsInCurrentRole - mean(YearsInCurrentRole)) / sd(YearsInCurrentRole))
  scaledJobs &lt;- scaledYear %&gt;% mutate(scaledJobLevel = (JobLevel - mean(JobLevel)) / sd(JobLevel))
  scaledSatis &lt;- scaledJobs %&gt;% mutate(scaledJobSatisfaction = (JobSatisfaction - mean(JobSatisfaction)) / sd(JobSatisfaction))
  scaledMI &lt;- scaledSatis %&gt;% mutate(scaledMI = (MonthlyIncome - mean(MonthlyIncome)) / sd(MonthlyIncome))
  scaledA &lt;- scaledMI %&gt;% mutate(scaledAge = (Age - mean(Age)) / sd(Age))
  scaledA
}

jobs &lt;- transformFields(jobs)</code></pre>
</div>
<div id="comparison-of-scaled-variables" class="section level2">
<h2>Comparison of Scaled Variables</h2>
<p>Scaling the variables allowed us to compare variable that had responses 1-4 (Job Satisfaction) to something with a scale of 18-60 (Age)</p>
<pre class="r"><code>jobs %&gt;% select(Attrition, OverTime, scaledJobLevel, scaledJobSatisfaction) %&gt;% ggpairs(mapping = aes(color=Attrition)) + ggtitle(&quot;Attrition vs Over Time, Scaled Job Level and Job Satisfaction&quot;)</code></pre>
<pre><code>## 
 plot: [1,1] [==&gt;-----------------------------------------------]  6% est: 0s 
 plot: [1,2] [=====&gt;--------------------------------------------] 12% est: 1s 
 plot: [1,3] [========&gt;-----------------------------------------] 19% est: 1s 
 plot: [1,4] [===========&gt;--------------------------------------] 25% est: 2s 
 plot: [2,1] [===============&gt;----------------------------------] 31% est: 2s 
 plot: [2,2] [==================&gt;-------------------------------] 38% est: 1s 
 plot: [2,3] [=====================&gt;----------------------------] 44% est: 1s 
 plot: [2,4] [========================&gt;-------------------------] 50% est: 1s 
 plot: [3,1] [===========================&gt;----------------------] 56% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [3,2] [==============================&gt;-------------------] 62% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [3,3] [=================================&gt;----------------] 69% est: 1s 
 plot: [3,4] [=====================================&gt;------------] 75% est: 1s 
 plot: [4,1] [========================================&gt;---------] 81% est: 0s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,2] [===========================================&gt;------] 88% est: 0s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,3] [==============================================&gt;---] 94% est: 0s 
 plot: [4,4] [==================================================]100% est: 0s 
                                                                              </code></pre>
<p><img src="DDSAnalyticsEDA_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>jobs %&gt;% select(MonthlyRate,scaledAge,scaledJobLevel, scaledJobSatisfaction) %&gt;% ggpairs() + ggtitle(&quot;Monthly Rate vs Scaled Age, Job Level and Job Satisfaction&quot;)</code></pre>
<pre><code>## plot: [1,1] [==&gt;-----------------------------------------------] 6% est: 0s
## plot: [1,2] [=====&gt;--------------------------------------------] 12% est: 0s
## plot: [1,3] [========&gt;-----------------------------------------] 19% est: 0s
## plot: [1,4] [===========&gt;--------------------------------------] 25% est: 0s
## plot: [2,1] [===============&gt;----------------------------------] 31% est: 0s
## plot: [2,2] [==================&gt;-------------------------------] 38% est: 0s
## plot: [2,3] [=====================&gt;----------------------------] 44% est: 0s
## plot: [2,4] [========================&gt;-------------------------] 50% est: 0s
## plot: [3,1] [===========================&gt;----------------------] 56% est: 0s
## plot: [3,2] [==============================&gt;-------------------] 62% est: 0s
## plot: [3,3] [=================================&gt;----------------] 69% est: 0s
## plot: [3,4] [=====================================&gt;------------] 75% est: 0s
## plot: [4,1] [========================================&gt;---------] 81% est: 0s
## plot: [4,2] [===========================================&gt;------] 88% est: 0s
## plot: [4,3] [==============================================&gt;---] 94% est: 0s
## plot: [4,4] [==================================================]100% est: 0s</code></pre>
<p><img src="DDSAnalyticsEDA_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
</div>
<div id="using-knn-to-predict-attrition" class="section level2">
<h2>Using KNN to Predict Attrition</h2>
<p>We will use the K-Nearest Neighbors model to evaluate datapoints ‘close’ to what we are trying to predict. Using the scaled values allows us to make this better reflect the variance within our dataset.</p>
<pre class="r"><code>#Identify the best k
#Set Split percentages for train and test sets
set.seed(10)
splitPerc = .8

#loop through values of k to find best model on 100 generated train/test combos
iterations = 50
numks = 80

masterSpec = matrix(nrow = iterations, ncol = numks)
masterSensitivity = matrix(nrow = iterations, ncol = numks)


fieldToTest = c(&quot;scaledJobLevel&quot;,&quot;OverTimeDummy&quot;, &quot;scaledJobSatisfaction&quot;)

for(j in 1:iterations)
{
  trainIndices = sample(1:dim(jobs)[1],round(splitPerc * dim(jobs)[1]))
  train = jobs[trainIndices,]
  test = jobs[-trainIndices,]
  for(i in 1:numks)
  {
    classifications = knn(train[,fieldToTest],test[, fieldToTest],train$Attrition, prob = TRUE, k = i)
    CM = confusionMatrix(table(classifications,test$Attrition))
    masterSensitivity[j,i] = CM$byClass[1]
    masterSpec[j,i] = CM$byClass[2]
  }
}</code></pre>
</div>
<div id="k-values-that-maximize-specificity-and-sensitivity" class="section level2">
<h2>K Values that Maximize Specificity and Sensitivity</h2>
<p>We can see that the Sensitivity goes up as we expand K. This is because the ‘Positive’ class being measured is those who did not leave. This portion of the population is much higher than those that left. While testing, we saw these high k values returning ‘No’ for all datapoints. Specificity is the most important, as we are looking for the employees where attrition is “Yes”. Therefore, we prioritized setting the k to maximize the True Negative rate.</p>
<pre class="r"><code>MeanSen = colMeans(masterSensitivity)
#plot k vs accuracy and identify k with highest accuracy
plot(seq(1,numks,1),MeanSen, type = &quot;l&quot;, main=&quot;Sensitivity of KNN model vs K value&quot;)</code></pre>
<p><img src="DDSAnalyticsEDA_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>MeanSpec = colMeans(masterSpec)
#plot k vs accuracy and identify k with highest accuracy
plot(seq(1,numks,1),MeanSpec, type = &quot;l&quot;, main=&quot;Specificity of KNN model vs K value&quot;)</code></pre>
<p><img src="DDSAnalyticsEDA_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<pre class="r"><code>paste(&quot;Highest Sensitivity K Value is &quot;, which.max(MeanSen))</code></pre>
<pre><code>## [1] &quot;Highest Sensitivity K Value is  69&quot;</code></pre>
<pre class="r"><code>paste(&quot;Highest Specificity K Value is &quot;, which.max(MeanSpec))</code></pre>
<pre><code>## [1] &quot;Highest Specificity K Value is  24&quot;</code></pre>
<div id="knn-using-best-k-value" class="section level3">
<h3>KNN Using Best K-Value</h3>
<p>Using the K Value from the Highest Specificity, we attained specificitys ranging from .26-.27. As we increased the training set size, this went up and we expect higher values in the true test set.</p>
<pre class="r"><code>#knn classification using the tuned value of k
set.seed(10)
trainIndices = sample(1:dim(jobs)[1],round(splitPerc * dim(jobs)[1]))
trainjobs = jobs[trainIndices,]
testjobs = jobs[-trainIndices,]
classif &lt;- knn(trainjobs[,fieldToTest],testjobs[,fieldToTest],trainjobs$Attrition, prob=TRUE, k=27)
confusionMatrix(table(classif,testjobs$Attrition))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##        
## classif  No Yes
##     No  141  19
##     Yes   7   7
##                                        
##                Accuracy : 0.8506       
##                  95% CI : (0.7888, 0.9)
##     No Information Rate : 0.8506       
##     P-Value [Acc &gt; NIR] : 0.55207      
##                                        
##                   Kappa : 0.2741       
##                                        
##  Mcnemar&#39;s Test P-Value : 0.03098      
##                                        
##             Sensitivity : 0.9527       
##             Specificity : 0.2692       
##          Pos Pred Value : 0.8812       
##          Neg Pred Value : 0.5000       
##              Prevalence : 0.8506       
##          Detection Rate : 0.8103       
##    Detection Prevalence : 0.9195       
##       Balanced Accuracy : 0.6110       
##                                        
##        &#39;Positive&#39; Class : No           
## </code></pre>
</div>
</div>
<div id="predictions-for-competition-set" class="section level2">
<h2>Predictions for Competition Set</h2>
<p>Given the set competition set, we will now apply this KNN model to the that dataset and save it for running against the correct values later. Given that as the split of our training set went up our specificity increased. We expect to see slightly higher specificty in this set.</p>
<pre class="r"><code>competitionAttrition = read.csv(&quot;CaseStudy2CompSet No Attrition.csv&quot;,header = TRUE)

  compdummied_overTime &lt;- competitionAttrition %&gt;% mutate(OverTimeDummy =sapply(OverTime, dummyBoolean,simplify = TRUE))
  compscaledYear &lt;- compdummied_overTime %&gt;% mutate(scaledYears = (YearsInCurrentRole - mean(YearsInCurrentRole)) / sd(YearsInCurrentRole))
  compscaledJobs &lt;- compscaledYear %&gt;% mutate(scaledJobLevel = (JobLevel - mean(JobLevel)) / sd(JobLevel))
  compscaledSatis &lt;- compscaledJobs %&gt;% mutate(scaledJobSatisfaction = (JobSatisfaction - mean(JobSatisfaction)) / sd(JobSatisfaction))
  compscaledA &lt;- compscaledSatis %&gt;% mutate(scaledAge = (Age - mean(Age)) / sd(Age))
scaledCompetitionAttrition = compscaledA

classif &lt;- knn(jobs[,fieldToTest],scaledCompetitionAttrition[,fieldToTest],jobs$Attrition, prob=TRUE, k=27)

datafromeWithClass &lt;- data.frame(scaledCompetitionAttrition$ID,data.frame(classif))


  write.csv(datafromeWithClass, file=&quot;Case2PredictionsLayne AttritionTEST.csv&quot;,row.names = FALSE)</code></pre>
<pre class="r"><code>summary(jobs$MonthlyRate)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    2094    8092   14074   14326   20456   26997</code></pre>
<pre class="r"><code>jobs %&gt;% ggplot(aes(x=MonthlyRate)) + geom_histogram(color=&quot;black&quot;, fill=&quot;white&quot;,bins = 30) + ggtitle(&quot;Salary Distribution&quot;)</code></pre>
<p><img src="DDSAnalyticsEDA_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="testing-the-linear-model-over-many-root-mean-squares" class="section level2">
<h2>Testing the Linear Model over many Root Mean Squares</h2>
<p>Our mean of running this linear regression model 1000 times to compare models with different scaled and dummy coded variables. The highest correlated variables to Montly Rate did not always result in a larger</p>
<pre class="r"><code>numMSPEs = 1000
RMSEHolderModel1 = numeric(numMSPEs)

for (i in 1:numMSPEs)
{
  TrainObs = sample(seq(1,dim(jobs)[1]),round(.8*dim(jobs)[1]),replace = FALSE)
  jobsTrain = jobs[TrainObs,]
  jobsTest = jobs[-TrainObs,]
  Model1_fit = lm(MonthlyRate ~ scaledAge + scaledJobLevel +scaledJobSatisfaction, data=jobsTrain)
  Model1_Preds = predict(Model1_fit, newdata = jobsTest)
  
  #MSPE Model 1
  RMSE = sqrt(mean((Model1_Preds - jobsTest$MonthlyRate)^2))
  RMSEHolderModel1[i] = RMSE
  
}
mean(RMSEHolderModel1)</code></pre>
<pre><code>## [1] 7111.594</code></pre>
</div>
<div id="predicting-the-competition-dataset" class="section level2">
<h2>Predicting the Competition DataSet</h2>
<p>We will now export the competition dataset for predictions</p>
<pre class="r"><code>competitionSalary = read.csv(&quot;CaseStudy2CompSet No Salary.csv&quot;,header = TRUE)
  compSalarydummied_overTime &lt;- competitionSalary %&gt;% mutate(OverTimeDummy =sapply(OverTime, dummyBoolean,simplify = TRUE))
  compSalaryscaledYear &lt;- compSalarydummied_overTime %&gt;% mutate(scaledYears = (YearsInCurrentRole - mean(YearsInCurrentRole)) / sd(YearsInCurrentRole))
  compSalaryscaledJobs &lt;- compSalaryscaledYear %&gt;% mutate(scaledJobLevel = (JobLevel - mean(JobLevel)) / sd(JobLevel))
  compSalaryscaledSatis &lt;- compSalaryscaledJobs %&gt;% mutate(scaledJobSatisfaction = (JobSatisfaction - mean(JobSatisfaction)) / sd(JobSatisfaction))
  compSalaryscaledA &lt;- compSalaryscaledSatis %&gt;% mutate(scaledAge = (Age - mean(Age)) / sd(Age))
scaledCompetitionSalary = compSalaryscaledA

  Model_fit = lm(MonthlyRate ~ scaledAge + scaledJobLevel + scaledJobSatisfaction , data=jobs)
  Competition_Preds = predict(Model_fit,newdata = scaledCompetitionSalary)
  dfpreds &lt;- data.frame(Competition_Preds)
  datafromeWithPred&lt;- data.frame(scaledCompetitionSalary$ID,dfpreds)
  write.csv(datafromeWithPred, file = &quot;Case2PredictionsLayne SalaryTEST.csv&quot;, row.names = FALSE, na=&quot;&quot;)</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
